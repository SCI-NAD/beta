---
import { Authenticator } from '@aws-amplify/ui-react';
import Layout from '../layouts/Page.astro';
import { Container } from '@components/odyssey-theme';

import '../../amplify-init'; // Ensure this path is correct

const seo = {
  title: 'Community | SCI-NAD',
  description: 'Join the SCI-NAD community and connect with fellow neuroscience enthusiasts.',
};

const handleSubmit = (event) => {
  event.preventDefault();
  const formData = new FormData(event.target);
  const bio = formData.get('bio');

  // Save the user bio to your backend or database here
  console.log('User bio:', bio);
};
---

<Layout seo={seo}>
  <Container>
    <section class="community-section">
      <Authenticator>
        {({ signOut, user }) => (
          user ? (
            <div class="auth-container">
              <h1>Welcome, {user.username}</h1>
              <button onclick={() => signOut()}>Sign out</button>
              <form onsubmit={handleSubmit}>
                <label for="bio">Bio:</label>
                <textarea id="bio" name="bio" required></textarea>
                <button type="submit">Save</button>
              </form>
            </div>
          ) : (
            <div class="non-auth-container">
              <h1>Join Our Community</h1>
              <p>Sign in to share your profile and connect with other members.</p>
            </div>
          )
        )}
      </Authenticator>
    </section>
  </Container>
</Layout>

<style>
  .community-section {
    margin: var(--section-margin) auto;
    min-height: calc(90vh - var(--navbar-height));
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 2rem;
  }
  .auth-container, .non-auth-container {
    padding: 2rem;
    background-color: var(--theme-surface-1);
    border-radius: var(--theme-shape-radius);
    width: 100%;
    max-width: 600px;
    text-align: center;
  }
  form {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    margin-top: 1rem;
  }
  @media (max-width: 768px) {
    .community-section {
      margin: var(--section-margin-mobile) auto;
    }
  }
</style>
